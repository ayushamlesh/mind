
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Payment Operations Console</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body{background:#f4f6f9;font-family:Inter,sans-serif}
.card-ui{background:#fff;border-radius:14px;padding:16px;box-shadow:0 4px 12px rgba(0,0,0,.06)}
.metric{font-size:26px;font-weight:600}
.neg{color:#dc3545}
.warn{color:#fd7e14}
.pos{color:#198754}
.muted{color:#6c757d}
.beh-card{cursor:pointer;transition:.2s}
.beh-card:hover{transform:translateY(-3px)}
#storeView{display:none}
</style>
</head>

<body>

<nav class="navbar navbar-dark bg-dark px-4">
<span class="navbar-brand fw-semibold">
<i class="bi bi-credit-card"></i> Payment Operations Console
</span>

<div class="d-flex gap-2">
<select class="form-select form-select-sm">
<option>Last 15 minutes</option>
<option>Last 30 minutes</option>
<option>Last 1 hour</option>
<option>Last 24 hours</option>
</select>

<select class="form-select form-select-sm" onchange="selectStore(this.value)">
<option value="">All Stores</option>
<option value="101">Store 101</option>
</select>
</div>
</nav>

<div class="container-fluid p-4">

<!-- ================= GLOBAL ================= -->
<div id="globalView">
<div class="alert alert-warning">
Approval deviation vs yesterday detected in 2 stores.
</div>
</div>

<!-- ================= STORE ================= -->
<div id="storeView">

<h5 id="storeTitle" class="mb-3"></h5>

<div class="row g-4 mb-4">
<div class="col-md-3"><div class="card-ui"><div class="muted">Approval</div><div class="metric" id="storeApproval"></div></div></div>
<div class="col-md-3"><div class="card-ui"><div class="muted">Yesterday</div><div class="metric" id="storeYesterday"></div></div></div>
<div class="col-md-3"><div class="card-ui"><div class="muted">Txns</div><div class="metric" id="storeTxns"></div></div></div>
<div class="col-md-3"><div class="card-ui"><div class="muted">Impacted Terminals</div><div class="metric warn" id="storeImpacted"></div></div></div>
</div>

<!-- Terminal behavior grouping -->
<div class="row g-3 mb-3">
<div class="col-md-3">
<div class="card-ui beh-card" onclick="filterTerminals('impacted')">
ðŸ”´ Impacted<br><span class="metric" id="cntImpacted"></span>
</div>
</div>
<div class="col-md-3">
<div class="card-ui beh-card" onclick="filterTerminals('degraded')">
ðŸŸ¡ Degraded<br><span class="metric" id="cntDegraded"></span>
</div>
</div>
<div class="col-md-3">
<div class="card-ui beh-card" onclick="filterTerminals('healthy')">
ðŸŸ¢ Healthy<br><span class="metric" id="cntHealthy"></span>
</div>
</div>
<div class="col-md-3">
<div class="card-ui beh-card" onclick="filterTerminals('all')">
ðŸ“‹ All Terminals<br><span class="metric" id="cntAll"></span>
</div>
</div>
</div>

<div class="card-ui">
<h6>Terminal Insights</h6>
<table class="table table-sm align-middle">
<thead>
<tr>
<th>Terminal</th>
<th>Txns</th>
<th>Approval</th>
<th>Vs Store Avg</th>
<th>Top Decline</th>
<th>Status</th>
</tr>
</thead>
<tbody id="terminalTable"></tbody>
</table>
</div>

</div>
</div>

<script>
const store={
id:"101",name:"Store 101",
approval:92.4,yesterday:95.1,txns:12480,
terminals:[
{t:"FP-01",tx:420,ap:96,reason:""},
{t:"FP-02",tx:360,ap:88,reason:"HOST_TIMEOUT"},
{t:"FP-03",tx:300,ap:81,reason:"HOST_TIMEOUT"},
{t:"FP-04",tx:280,ap:90,reason:"NO_RESPONSE"},
{t:"PH-01",tx:390,ap:95,reason:""}
]
};

let currentFilter="impacted";

function selectStore(id){
if(!id){
document.getElementById("storeView").style.display="none";
document.getElementById("globalView").style.display="block";
return;
}
document.getElementById("globalView").style.display="none";
document.getElementById("storeView").style.display="block";
document.getElementById("storeTitle").innerText=store.name;
document.getElementById("storeApproval").innerText=store.approval+"%";
document.getElementById("storeYesterday").innerText=store.yesterday+"%";
document.getElementById("storeTxns").innerText=store.txns;

categorize();
filterTerminals("impacted");
}

function categorize(){
let imp=0,deg=0,heal=0;
store.terminals.forEach(t=>{
const d=t.ap-store.approval;
if(d<-10) imp++;
else if(d<-3) deg++;
else heal++;
});
document.getElementById("cntImpacted").innerText=imp;
document.getElementById("cntDegraded").innerText=deg;
document.getElementById("cntHealthy").innerText=heal;
document.getElementById("cntAll").innerText=store.terminals.length;
document.getElementById("storeImpacted").innerText=imp;
}

function filterTerminals(type){
currentFilter=type;
const tb=document.getElementById("terminalTable");
tb.innerHTML="";
store.terminals.forEach(t=>{
const dev=(t.ap-store.approval).toFixed(1);
let status="Healthy",cls="success";
if(dev<-10){status="Impacted";cls="danger";}
else if(dev<-3){status="Degraded";cls="warning";}
if(type!=="all"){
if(type==="impacted" && status!=="Impacted") return;
if(type==="degraded" && status!=="Degraded") return;
if(type==="healthy" && status!=="Healthy") return;
}
tb.innerHTML+=`
<tr>
<td>${t.t}</td>
<td>${t.tx}</td>
<td>${t.ap}%</td>
<td class="${dev<0?'neg':'pos'}">${dev}%</td>
<td>${t.reason||"-"}</td>
<td><span class="badge bg-${cls}">${status}</span></td>
</tr>`;
});
}
</script>

</body>
</html>
