
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Payment Operations Console</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body{background:#f4f6f9;font-family:Inter,sans-serif}
.card-ui{background:#fff;border-radius:14px;padding:16px;box-shadow:0 4px 12px rgba(0,0,0,.06)}
.metric{font-size:26px;font-weight:600}
.neg{color:#dc3545}
.warn{color:#fd7e14}
.pos{color:#198754}
.muted{color:#6c757d}
.click{cursor:pointer}
#storeView{display:none}
</style>
</head>

<body>

<nav class="navbar navbar-dark bg-dark px-4">
<span class="navbar-brand fw-semibold">
<i class="bi bi-credit-card"></i> Payment Operations Console
</span>

<div class="d-flex gap-2">
<select class="form-select form-select-sm">
<option>Last 15 minutes</option>
<option>Last 30 minutes</option>
<option>Last 1 hour</option>
<option>Last 24 hours</option>
</select>

<select class="form-select form-select-sm" onchange="selectStore(this.value)">
<option value="">All Stores</option>
<option value="101">Store 101</option>
<option value="108">Store 108</option>
</select>
</div>
</nav>

<div class="container-fluid p-4">

<!-- ================= GLOBAL VIEW ================= -->
<div id="globalView">

<div class="alert alert-warning">
<strong>Insights:</strong>
Approval degradation vs yesterday observed in 2 stores.
HOST_TIMEOUT concentrated in Fuel terminals.
</div>

<!-- Store health bands -->
<div class="row g-4 mb-4">
<div class="col-md-4">
<div class="card-ui text-center click" onclick="filterStores('healthy')">
ðŸŸ¢ Healthy Stores
<div class="metric" id="cntHealthyStores"></div>
</div>
</div>
<div class="col-md-4">
<div class="card-ui text-center click" onclick="filterStores('watch')">
ðŸŸ¡ Watch Stores
<div class="metric warn" id="cntWatchStores"></div>
</div>
</div>
<div class="col-md-4">
<div class="card-ui text-center click" onclick="filterStores('impacted')">
ðŸ”´ Impacted Stores
<div class="metric neg" id="cntImpactedStores"></div>
</div>
</div>
</div>

<!-- Store list -->
<div class="card-ui">
<div class="d-flex justify-content-between mb-2">
<h6>Store Overview</h6>
<input class="form-control form-control-sm w-25" placeholder="Search store..." onkeyup="searchStore(this.value)">
</div>

<table class="table table-sm align-middle">
<thead>
<tr>
<th>Store</th>
<th>Txns</th>
<th>Approval</th>
<th>Vs Yesterday</th>
<th>Impacted Terminals</th>
<th>Top Decline</th>
</tr>
</thead>
<tbody id="storeTable"></tbody>
</table>
</div>

</div>

<!-- ================= STORE VIEW (UNCHANGED) ================= -->
<div id="storeView">
<h5 id="storeTitle" class="mb-3"></h5>
<!-- (store-specific UI remains exactly as you already approved) -->
</div>

</div>

<script>
const stores=[
{ id:"101", name:"Store 101", txns:12480, approval:92.4, yesterday:95.1, impacted:5, reason:"HOST_TIMEOUT"},
{ id:"108", name:"Store 108", txns:8920, approval:89.7, yesterday:93.8, impacted:7, reason:"NO_RESPONSE"},
{ id:"115", name:"Store 115", txns:10220, approval:96.8, yesterday:96.5, impacted:0, reason:"-" }
];

let currentFilter="all";

function classify(s){
const diff=s.approval-s.yesterday;
if(diff<-3) return "impacted";
if(diff<0) return "watch";
return "healthy";
}

function renderGlobal(){
let h=0,w=0,i=0;
stores.forEach(s=>{
const c=classify(s);
if(c==="healthy") h++;
if(c==="watch") w++;
if(c==="impacted") i++;
});
cntHealthyStores.innerText=h;
cntWatchStores.innerText=w;
cntImpactedStores.innerText=i;
renderStoreTable();
}

function renderStoreTable(search=""){
const tb=document.getElementById("storeTable");
tb.innerHTML="";
stores.filter(s=>{
if(currentFilter!=="all" && classify(s)!==currentFilter) return false;
if(search && !s.name.toLowerCase().includes(search.toLowerCase())) return false;
return true;
}).sort((a,b)=>a.approval-b.approval)
.forEach(s=>{
const diff=(s.approval-s.yesterday).toFixed(1);
tb.innerHTML+=`
<tr class="click" onclick="selectStore('${s.id}')">
<td>${s.name}</td>
<td>${s.txns}</td>
<td>${s.approval}%</td>
<td class="${diff<0?'neg':'pos'}">${diff}%</td>
<td>${s.impacted}</td>
<td>${s.reason}</td>
</tr>`;
});
}

function filterStores(type){
currentFilter=type;
renderStoreTable();
}

function searchStore(v){
renderStoreTable(v);
}

function selectStore(id){
if(!id){
storeView.style.display="none";
globalView.style.display="block";
return;
}
globalView.style.display="none";
storeView.style.display="block";
storeTitle.innerText=id+" (Store View)";
}

renderGlobal();
</script>

</body>
</html>
